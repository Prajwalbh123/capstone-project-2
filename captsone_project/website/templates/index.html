<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MapView</title>
    <style>
       body {
    margin: 0;
      padding: 0;
      transition: margin-left 0.5s;
      background-color: lightblue;
      
    }

    #map {
            height: 1080px;
            width: auto;
            transition: margin-left 0.5s;
            z-index: 2;

        }

        .map-open {
      margin-left: 400px;
    }

.additional-content {
      padding: 20px;
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 1;
    }          

    button {
      padding: 10px;
      cursor: pointer;
      z-index: 3;
    }
     

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            max-width: 400px;
            text-align: center;
        }

        #modal-image {
            max-width: 100%;
            max-height: 400px;
        }

        .minimize {
            margin-top: 10px;
            cursor: pointer;
            color: blue;
            text-decoration: underline;
        }

        .close {
            position: absolute;
            top: 0;
            right: 0;
            padding: 10px;
            cursor: pointer;
        }

        .logout {
            padding-top: 90%;
        }

    
    #hide{
        display: none;
    }

    #hide1{
        display: none;
    }
    
        #imageInput,
        #descriptionInput,
        #uploadButton {
            margin: 10px;
        }
        
    </style>
    <script src=" https://maps.googleapis.com/maps/api/js?key=AIzaSyCrTZ5ngLS7UbsbQXIDH6Kx3TtGMXl-SCw&callback=initMap
    " async defer></script>
</head>
<body>
	<button onclick="clearLocalStorage()">Clear Local Storage</button>
    <button onclick="toggleSlide()">Menu</button>
    <div class="container">
        <div class="main-content" id="map">
        </div>
        <div class="additional-content" id="additionalContent">
            <button onclick="toggleText()">Add Friends</button>

            <div id="hide">
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" placeholder="Enter username">
        
            <button onclick="submitForm()">Submit</button>
            </div>

            <br>
            <br>

            <button onclick="toggleText1()">Add Group</button>

            <div id="hide1">
            <label for="groupid">Group ID:</label>
            <input type="text" id="groupid" name="groupid" placeholder="Enter GroupID">
        
            <button onclick="submitForm()">Submit</button>
            </div>
           <script>
            function toggleText() {
                var textElement = document.getElementById('hide');

                // Toggle the visibility of the text
                if (textElement.style.display === 'none') {
                  textElement.style.display = 'block';
                } else {
                  textElement.style.display = 'none';
                }
              }

              function toggleText1() {
                var textElement = document.getElementById('hide1');
          
                // Toggle the visibility of the text
                if (textElement.style.display === 'none') {
                  textElement.style.display = 'block';
                } else {
                  textElement.style.display = 'none';
                }
              }
              </script>
            <br>
            <br>
            <br>

            <h3>Your Friends</h3>
            <ul id="friendsList">

            </ul>
<br>
<br>
            <h3>Your Groups</h3>
            <ul id="groupList">

            </ul>
            <div class="logout"> 

                <button onclick="logout()">Logout</button>

            </div>

        </div>
      </div>
    
      
    
      <script>
        function toggleSlide() {
             document.body.classList.toggle('map-open');

        }
      </script>
    


<div id="map"></div>
<div id="myModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <img id="modal-image" src="" alt="Uploaded Image">
        <div class="minimize" onclick="minimizeImage()">Minimize</div>
    </div>
</div>

<script>
   function initMap() {
    let map;
    let markers = [];

    function uploadInfo(index, position, button) {
        var imageInput = document.getElementById('imageInput');
        var descriptionInput = document.getElementById('descriptionInput');

        // Save data to local storage with marker-specific keys
        localStorage.setItem('uploadedImage_' + index, imageInput.value);
        localStorage.setItem('uploadedDescription_' + index, descriptionInput.value);

        alert('Image and description saved locally.');  // Notify the user that data is saved

        // You can clear the input fields if needed
        imageInput.value = '';
        descriptionInput.value = '';

        // Close the info window
        markers[index].infoWindow.close();
    }

    function displayInfo(index) {
        var uploadedImage = localStorage.getItem('uploadedImage_' + index);
        var uploadedDescription = localStorage.getItem('uploadedDescription_' + index);

        if (uploadedImage && uploadedDescription) {
            alert('Saved Image: ' + uploadedImage + '\nSaved Description: ' + uploadedDescription);
        } else {
            alert('No data found for this marker.');
        }
    }

    map = new google.maps.Map(document.getElementById('map'), {
        center: { lat: 0, lng: 0 },
        zoom: 2
    });

    google.maps.event.addListener(map, 'click', function(event) {
        var marker = new google.maps.Marker({
            position: event.latLng,
            map: map,
            draggable: true
        });

        var infoWindow = new google.maps.InfoWindow({
            content: '<div id="content">' +
                '<input type="file" id="imageInput" accept="image/*">' +
                '<br>' +
                '<textarea id="descriptionInput" placeholder="Enter your description"></textarea>' +
                '<br>' +
                '<button id="uploadButton" onclick="uploadInfo(' + markers.indexOf(marker) + ', \'' + marker.getPosition().toUrlValue() + '\', this)">Upload</button>' +
                '</div>'
        });

        marker.infoWindow = infoWindow;

        google.maps.event.addListener(marker, 'click', function() {
            infoWindow.open(map, marker);
        });

        markers.push(marker);
    });

    google.maps.event.addListener(map, 'click', function(event) {
        markers.forEach(function(marker, index) {
            if (marker.getPosition().equals(event.latLng)) {
                google.maps.event.addListener(marker, 'click', function() {
                    displayInfo(index);
                });
            }
        });
    });
}

  function addMarker(location) {
    // Create a marker
    const marker = new google.maps.Marker({
      position: location,
      map: map,
      draggable: true
    });

    // Add the marker to the markers array
    markers.push(marker);

    // Add a click event listener to the marker
    google.maps.event.addListener(marker, 'click', function() {
    var index = markers.indexOf(marker);
    var uploadedImage = localStorage.getItem('uploadedImage_' + index);
    var uploadedDescription = localStorage.getItem('uploadedDescription_' + index);

    if (uploadedImage && uploadedDescription) {
        // Implement logic to display the saved data
        alert('Saved Image: ' + uploadedImage + '\nSaved Description: ' + uploadedDescription);
    } else {
        alert('No data found for this marker.');
    }
});
  }

  function openUploadForm(marker) {
    // Display the upload form
    document.getElementById('uploadForm').style.display = 'block';

    // Save the current marker in a hidden field
    document.getElementById('imageForm').marker = marker;
  }

  function saveMarkerData() {
    // Get the current marker
    const marker = document.getElementById('imageForm').marker;

    // Get user inputs
    const imageInput = document.getElementById('imageInput');
    const descriptionInput = document.getElementById('descriptionInput');

    // Get the file and description
    const file = imageInput.files[0];
    const description = descriptionInput.value;

    // Perform actions with the file and description, e.g., upload to a server

    // Add a listener to remove the form after saving
    google.maps.event.addListenerOnce(marker, 'dragend', function() {
      // Remove the form
      document.getElementById('uploadForm').style.display = 'none';

      // Clear the marker reference in the form
      document.getElementById('imageForm').marker = null;

      // Clear the inputs
      imageInput.value = '';
      descriptionInput.value = '';
    });
  }




    function clearLocalStorage() {
            localStorage.clear(); // Use this line to clear all local storage data
            // Alternatively, you can use localStorage.removeItem('specificKey') to clear specific keys
            alert('Local storage data cleared.');
        }


</script>
</body>
</html>